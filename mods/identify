#!/bin/bash

username="$1"
password="$2"

case $chan in
	# first of all, check if we are authenticating in public
	\#*)
	echo "warning: $source_nick tried identifying in a channel!"
	answer "don't identify in a channel, dumb-ass!"
	if [[ ! "$password" == "" ]]; then
		echo "critical: $source_nick identified in a channel! account [disabled]."
		answer "great! stating your password here was a very smart idea... idot!"
		answer "i am disabling your account, fool."
		echo "yet to come..."
	fi
	;;
	
	# authenticate
	*)
	if [[ -z "$(cat $nick.acl | grep $username)" ]]; then
		acl_auth $username $password
		if [[ -n "$(cat $nick.acl | grep $hostmask)" ]]; then
			answer "Authentication successfull!"
		else
			answer "Authentication failed!"
		fi
	else
		echo "Warning: $username ist trying to authenticate from $hostmask while logged in from $(cat $nick.acl | grep $username | cut -d: -f1)."
		answer "Authentication failed! You are allready logged in."
	fi
esac

