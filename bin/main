#!/bin/bash
# Script: main
# Description: Script for crawling incoming irc lines
#
# - Splits line into segments: $head $body $hostmask $source_nick $flag 
#
# - These variables are used throughout the entire script for further processing
#   and addressing reply messages, so this is basically where the magic happens.
#
# - If a nickname is found in the message line, we assume some sort of chat event
#   and pass over to the trigger engine.

nickchar="!"

header="$(echo $line | cut -d ":" -f 2)"
body="${line:$(expr ${#header} + 1)}"
hostmask="$(echo $header | cut -d " " -f 1)"

if [[ "$hostmask" =~ "${nickchar}" ]]; then
	# there is a source_nick
	source_nick=$(echo $hostmask | cut -d "!" -f 1)
	flag=$(echo $header | cut -d " " -f 2)
	. bin/trigger
fi
