#!/bin/bash
# Script: main
# Description: Script for crawling incoming irc lines
#
# - Splits line into segments: $head $body $hostmask $source_nick $flag 
#
# - These variables are used throughout the entire script for further processing
#   and addressing reply messages, so this is basically where the magic happens.
#
# - If a nickname is found in the message line, we assume some sort of chat
#   event and pass over to the trigger engine.
#
# - I just realized that it would be much smarter to just loop through the
#   entire line word by word as in:
#   for word in $(echo $line); do echo $word; done
#
#   I'll put some more thoughts into it first, though before restructoring the
#   entire bot just cause it seemed smart.

nickchar="!"

header="$(echo $line | cut -d ":" -f 2)"
body="${line:$(expr ${#header} + 2)}"
hostmask="$(echo $header | cut -d " " -f 1)"

if [[ "$hostmask" =~ "${nickchar}" ]]; then
	# there is a source_nick
	source_nick=$(echo $hostmask | cut -d "!" -f 1)
	flag=$(echo $header | cut -d " " -f 2)
	. bin/trigger
fi
